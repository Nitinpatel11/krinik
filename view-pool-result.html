<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>View Pool Result</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      content="Premium Multipurpose Admin & Dashboard Template"
      name="description"
    />
    <meta content="Themesdesign" name="author" />
    <!-- App favicon -->
    <!-- <link rel="shortcut icon" href="./assets/images/favicon.ico" /> -->
    <link rel="icon" href="./assets/images/krinikIn_Logo.svg" type="image/x-icon" >
    <!-- DataTables -->
    <link
      href="./assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="./assets/libs/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css"
      rel="stylesheet"
      type="text/css"
    />

    <!-- Responsive datatable examples -->
    <link
      href="./assets/libs/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,300,0,0" />

    <!-- datepicker -->
    <link
      href="./assets/libs/air-datepicker/air-datepicker.css"
      rel="stylesheet"
      type="text/css"
    />

    <!-- jvectormap -->
    <!-- <link href="./assets/libs/jqvmap/jqvmap.min.css" rel="stylesheet" /> -->

    <!-- Bootstrap Css -->
    <link
      href="./assets/css/bootstrap.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <!-- Icons Css -->
    <link href="./assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="./assets/css/app.css" rel="stylesheet" type="text/css" />
    <style>
        .player_run{
            width: 250px;
        }
         .table-bordered th, .table-bordered td {
            /* border: 1px solid #dee2e6 !important; */
        }
        .run{
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9; 
        }
        .table-responsive {
            overflow-x: auto;
          }
          .table thead th {
            white-space: nowrap;
            border : 1px solid grey;
            padding: 10px 0px;
          }
          .table tbody td {
            /* width: 500px; */
            vertical-align: middle;
             border : 1px solid grey;
             background-color: #f9f9f9; 
             text-align: center;
          }
          .form-control {
            text-align: center;
          }
          thead th{
            text-align:center;
          }
        @media (max-width: 767.98px) {
            .table-responsive input {
              width: 100%;
            }
            td{
                text-wrap:nowrap;
            }
          }
          @media (max-width: 567px) {
            .table-responsive input {
              width: 150px !important;
            }
            td{
                text-wrap:nowrap;
            }
          }
    </style>
  </head>

  <body data-topbar="colored">
    <!-- Begin page -->
    <div id="layout-wrapper">
      <header id="page-topbar" class="">
        <div class="navbar-header ">
          <div class="d-flex ">
            <!-- LOGO -->
            <div class="navbar-brand-box">
              <a href="./dashboard.html" class="logo logo-dark">
                <span class="logo-sm">
                  
                  <img src="./assets/images/krinikIn_Logo.svg" alt="" />
                </span>
                <span class="logo-lg">
                
                  <img src="./assets/images/krinikIn_Logo.svg" alt=""  />
                </span>
              </a>
  
              <a href="index.html" class="logo logo-light ">
                <span class="logo-sm">
               
                  <img src="./assets/images/krinikIn_Logo.svg" alt=""  />
                </span>
                <span class="logo-lg">
                  
                  <img src="./assets/images/krinikIn_Logo.svg" alt="" />
                </span>
              </a>
            </div>
  
            <button type="button" class="btn btn-sm px-3 font-size-24 header-item waves-effect " id="vertical-menu-btn">
              <i class="mdi mdi-backburger "></i>
            </button>
  
            <!-- App Search-->
            <!-- <form class="app-search d-none d-lg-block">
                              <div class="position-relative mt-3">
                                  <input type="text" class="form-control" placeholder="Search...">
                                  <span class="mdi mdi-magnify"></span>
                              </div>
                          </form> -->
          </div>
  
          <div class="  d-flex justify-content-center gap-4 time_show1">
            <div class="dropdown d-flex justify-content-end ms-2  " id="enterotpdiv">
              <!-- <button id="showotppage" type="button" class="btn btn-primary2  waves-effect" 
               >Enter OTP
              </button> -->
              
            </div>
          
            <div class="dropdown   dblock">
              <div id="time_show" class="btn-primary2  px-3">
              </div>
            </div>
  
            
          </div>
          
        </div>
      </header>
  
         <!-- ========== Left Sidebar Start ========== -->
         <div class="vertical-menu ">
          <div data-simplebar class="h-100 ">
            <!--- Sidemenu -->
            <div id="sidebar-menu" class="">
              <!-- Left Menu Start -->
              <ul class="metismenu list-unstyled " id="side-menu">
                <li class="menu-title">Menu</li>
    
                <li>
                  <a href="./dashboard.html" class="waves-effect">
                    <div class=" icons-sm icon-set">
                      <span class="material-symbols-outlined icon-margin">
                        dashboard
                        </span>
                   
                    <span>Dashboard</span>
                    </div>
                  </a>
                </li>
    
                <li>
                  <a href="./user.html" class="waves-effect">
                    <div class="icons-sm icon-set">
                      <span class="material-symbols-outlined icon-margin">
                        person
                        </span>
                   
                    <span>User</span>
                  </div>
                  </a>
                </li>
    
                <li>
                  <a href="javascript: void(0);" class=" ">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        sports_cricket
                        </span>                    
                        <span class="has-arrow waves-effect ">Sports Configuration</span>
                                        
                      </div> 
                      
                    </a>
    
                  <ul class="sub-menu" aria-expanded="false">
                    <li><a href="./manage-league.html">Manage Leagues</a></li>
                    <li><a href="./manage-team.html">Manage Teams</a></li>
                    <li><a href="./manage-player.html">Manage Players</a></li>
                  </ul>
                </li>
                
                <li>
                  <a href="javascript: void(0);" class=" ">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        crossword
                        </span>                   
                        <span class="has-arrow has-arrow1 waves-effect ">Manage Contest</span>
                                        
                      </div> 
                      
                    </a>
    
                  <ul class="sub-menu" aria-expanded="false">
                    <li><a href="./manage-match.html">Manage Match</a></li>
                    <li><a href="./manage-pool.html">Manage Pools</a></li>
                  </ul>
                </li>
    
                <li class="otp-exempt" style="display:none">
                  <a href="javascript: void(0);" class=" ">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        receipt_long
                        </span>                 
                        <span class="has-arrow has-arrow2 waves-effect ">Transactions</span>
                                        
                      </div> 
                      
                    </a>
    
                  <ul class="sub-menu" aria-expanded="false">
                    <li><a href="./all-transaction.html">All Transaction</a></li>
                    <li><a href="./wallet-transaction.html">Wallet Transaction</a></li>
                    <li><a href="./game-transaction.html">Game Transaction</a></li>
                  </ul>
                </li>
    
                <li class="otp-exempt" style="display:none">
                  <a href="./account-setting.html" class="waves-effect">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        settings
                        </span>
                        <span>Account Setting</span>
                    </div>
                  </a>
                </li>
                <li class="otp-exempt" style="display:none">
                  <a href="./withdrawal.html" class="waves-effect">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        payments
                        </span>
                        <span>Withdrawal Request</span>
                    </div>
                  </a>
                </li>
                <li class="otp-exempt" style="display:none">
                  <a href="./advertise.html" class="waves-effect">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        ads_click
                        </span>
                        <span>Advertise</span>
                    </div>
                  </a>
                </li>
                <li class="otp-exempt" style="display:none">
                  <a href="./scratch-card.html" class="waves-effect">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        award_star
                        </span>
                        <span>Scratch</span>
                    </div>
                  </a>
                </li>
               
                <li>
                  <a href="./kyc.html" class="waves-effect">
                    <div class="icons-sm icon-set">
                      <span class="material-symbols-outlined icon-margin">
                        person
                        </span>
                   
                    <span>KYC</span>
                  </div>
                  </a>
                </li>
    
                <li>
                  <a href="" class="waves-effect " id="logoutButton">
                    <div class=" icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin ">
                        logout
                        </span>
                        <span class="">Logout</span>
                    </div>
                  </a>
                </li>
    
              
                        </ul>
            </div>
            <!-- Sidebar -->
          </div>
        </div>
    <!-- Left Sidebar End -->

      <!-- ============================================================== -->
      <!-- Start right Content here -->
      <!-- ============================================================== -->
      <div class="main-content">
        <div class="page-content">
          <!-- Page-Title -->
          <div class="page-title-box">
            <div class="container-fluid">
              <div class="row align-items-center">
              
                <div>
                  <h4 class="page-title mb-1">View Pool Result</h4>
                </div>
              </div>
            </div>
          </div>
          <!-- end page title end breadcrumb -->

          <div class="page-content-wrapper">
            <div class="container-fluid">
              <!-- end row -->

              <div class="row">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-12">
                      <div class="card">
                        <div class="card-body">
                          <div class="col-xl-8 mb-3 d-flex justify-content-end">
                            <div class="d-flex align-items-end">
                              <form class="app-search d-lg-block d-flex">
                                <div
                                  class="d-flex gap-4 align-items-center justify-content-end flex-wrap"
                                >
                                  <!-- <div class="dropdown">
                                    <a class="btn dropbtn-color dropdown-toggle" href="#" data-bs-toggle="dropdown" aria-expanded="false">
                                        status <i class="mdi mdi-chevron-down"></i>
                                    </a>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#">Running</a></li>
                                        <li><a class="dropdown-item" href="#">Completed</a></li>
                                        <li><a class="dropdown-item" href="#">Upcoming</a></li>
                                    </ul>
                                </div>  -->
                                  <div
                                    class="align-items-center d-flex dropbtn-color justify-content-between"
                                  >
                                    <div>
                                      <span
                                        class="mdi mdi-magnify dropbtn-color-2"
                                      ></span>
                                    </div>
                                    <div>
                                      <input
                                        type="text"
                                        class="dropbtn-color-2"
                                        placeholder="Search..."
                                      />
                                    </div>
                                  </div>
                                  <div>
                                    <a
                                      href="addteam.html"
                                      type="button"
                                      class="btn dropbtn-color addnew"
                                      >Add New</a
                                    >
                                  </div>
                                </div>
                              </form>
                            </div>
                          </div>
                          <div class="container">
                            <div class="table-responsive">
                              <table id="tech-companies-1" class="table table-striped table-bordered table-hover">
                                <thead class="align-items-center">
                                  <tr>
                                    <th>NO</th>
                                    <th>Players name</th>
                                    <th>Team</th>
                                    <th>Run</th>
                                  </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>Player 1</td>
                                        <td>Team A</td>
                                        <td class="player_run">
                                            <input type="text" class="form-control run" placeholder="Player Run" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>Player 2</td>
                                        <td>Team B</td>
                                        <td class="player_run">
                                            <input type="text" class="form-control run" placeholder="Player Run" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>Player 3</td>
                                        <td>Team C</td>
                                        <td class="player_run">
                                            <input type="text" class="form-control run" placeholder="Player Run" />
                                        </td>
                                    </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                            <div class="row">
                              <div class="col-sm-12 col-md-5">
                                <div
                                  class="dataTables_info"
                                  id="datatable_info"
                                  role="status"
                                  aria-live="polite"
                                >
                                  Showing 1 to 10 of 57 entries
                                </div>
                              </div>
                              <div class="col-sm-12 col-md-7">
                                <div
                                  class="dataTables_paginate paging_simple_numbers pagination"
                                  id="datatable_paginate"
                                >
                                  <ul
                                    class="pagination-list d-flex list-unstyled"
                                  >
                                    <li
                                      class="paginate_button page-item previous disabled"
                                      id="prev-button"
                                    >
                                      <a
                                        aria-controls="datatable"
                                        aria-disabled="true"
                                        role="link"
                                        data-dt-idx="previous"
                                        tabindex="-1"
                                        class="page-link"
                                        >Previous</a
                                      >
                                    </li>
                                    <li
                                      class="paginate_button page-item active"
                                    >
                                      <a
                                        href="#"
                                        aria-controls="datatable"
                                        role="link"
                                        aria-current="page"
                                        data-dt-idx="0"
                                        tabindex="0"
                                        class="page-link"
                                        >1</a
                                      >
                                    </li>
                                    <li class="paginate_button page-item">
                                      <a
                                        href="#"
                                        aria-controls="datatable"
                                        role="link"
                                        data-dt-idx="1"
                                        tabindex="0"
                                        class="page-link"
                                        >2</a
                                      >
                                    </li>
                                    <li
                                      class="paginate_button page-item next"
                                      id="next-button"
                                    >
                                      <a
                                        href="#"
                                        aria-controls="datatable"
                                        role="link"
                                        data-dt-idx="next"
                                        tabindex="0"
                                        class="page-link"
                                        >Next</a
                                      >
                                    </li>
                                  </ul>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- end col -->
                  </div>
                  <!-- end row -->
                </div>
              </div>
              <!-- end row -->
            </div>
            <!-- container-fluid -->
          </div>
          <!-- end page-content-wrapper -->
        </div>
        <!-- End Page-content -->

        <footer class="footer">
          <div class="container-fluid">
            <div class="row">
              <div class="col-sm-6">2024 © Krinik.</div>
              <div class="col-sm-6">
                <div class="text-sm-end d-none d-sm-block">
                  Crafted with <i class="mdi mdi-heart text-danger"></i> by
                  Themesdesign
                </div>
              </div>
            </div>
          </div>
        </footer>
      </div>
      <!-- end main content-->
    </div>
    <!-- END layout-wrapper -->

   

    <!-- JAVASCRIPT -->
    <script src="./assets/libs/jquery/jquery.min.js"></script>
    <script src="./assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="./assets/libs/metismenu/metisMenu.min.js"></script>
    <script src="./assets/libs/simplebar/simplebar.min.js"></script>
    <script src="./assets/libs/node-waves/waves.min.js"></script>

    <script src="https://unicons.iconscout.com/release/v2.0.1/script/monochrome/bundle.js"></script>
    <script src="./assets/js/logout.js"></script>

    <!-- Required datatable js -->
    <script src="./assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="./assets/libs/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
    <!-- Buttons examples -->
    <script src="./assets/libs/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="./assets/libs/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
    <script src="./assets/libs/jszip/jszip.min.js"></script>
    <!-- <script src="./assets/libs/pdfmake/build/pdfmake.min.js"></script> -->
    <!-- <script src="./assets/libs/pdfmake/build/vfs_fonts.js"></script> -->
    <script src="./assets/libs/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="./assets/libs/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="./assets/libs/datatables.net-buttons/js/buttons.colVis.min.js"></script>
    <!-- Responsive examples -->
    <script src="./assets/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="./assets/libs/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>

    <!-- datepicker -->
    <script src="./assets/libs/air-datepicker/air-datepicker.js"></script>
    <script src="./assets/libs/air-datepicker/air-datepicker.js"></script>

    <!-- apexcharts -->
    <!-- <script src="./assets/libs/apexcharts/apexcharts.min.js"></script> -->

    <script src="./assets/libs/jquery-knob/jquery.knob.min.js"></script>

    <!-- Jq vector map -->
    <!-- <script src="./assets/libs/jqvmap/jquery.vmap.min.js"></script> -->
    <!-- <script src="./assets/libs/jqvmap/maps/jquery.vmap.usa.js"></script> -->

    <script src="./assets/js/pages/dashboard.init.js"></script>

    <script src="./assets/js/app.js"></script>

    <!-- <script>
      let currentPage = 1;
      const itemsPerPage = 10;
      let totalItems = 50;
      let allData = [];
  
      async function myFetch(url, type, data) {
          try {
              let responseData;
  
              if (type === "GET") {
                  const res = await fetch(url, {
                      method: type,
                      headers: {
                          'Content-Type': 'application/json'
                      }
                  });
  
                  if (res.ok) {
                      console.log("HTTP request successful");
                      responseData = await res.json();
                  } else {
                      console.log("HTTP request unsuccessful");
                  }
              } else if (type === "DELETE") {
                  const res = await fetch(url, {
                      method: type,
                      headers: {
                          'Content-Type': 'application/json'
                      }
                  });
  
                  if (res.ok) {
                      console.log("HTTP request successful");
                      return res;
                  } else {
                      console.log("HTTP request unsuccessful");
                  }
              } else if (type === "POST" || type === "PUT") {
                  const res = await fetch(url, {
                      method: type,
                      headers: {
                          'Content-Type': 'application/json'
                      },
                      body: JSON.stringify(data)
                  });
  
                  if (res.ok) {
                      console.log("HTTP request successful");
                      responseData = await res.json();
                  } else {
                      console.log("HTTP request unsuccessful");
                  }
              }
  
              if (responseData) {
                  allData = responseData.data;
                  populateTable(allData);
                  
              }
          } catch (error) {
              console.error("Fetch error:", error);
          }
      }

      function populateTable(data) {
          const tbody = document.querySelector("#tech-companies-1 tbody");
          tbody.innerHTML = "";
  
          const start = (currentPage - 1) * itemsPerPage;
          const end = start + itemsPerPage;
          const paginatedData = data.slice(start, end);
  
          if (Array.isArray(paginatedData)) {
              paginatedData.forEach((item, index) => {
                  const row = document.createElement("tr");
                  row.style.alignItems = "center";
  
                  const noCell = document.createElement("td");
                  noCell.textContent = start + index + 1;
                 
                  row.appendChild(noCell);
  
                  const fullNameCell = document.createElement("td");
                  fullNameCell.textContent = item.league_name;
                  row.appendChild(fullNameCell);
                  
  
                  const shortNameCell = document.createElement("td");
                  shortNameCell.textContent = item.short_league_name;
                  row.appendChild(shortNameCell);
  
                  const logoCell = document.createElement("td");
                  const logoImg = document.createElement("img");
                  logoImg.src = `https://jadavnilesh.pythonanywhere.com/${item.league_image}/`;
                  logoImg.alt = item.league_image;
                  logoImg.style.width = "50px";
                  logoImg.style.height = "50px";
                  logoImg.style.borderRadius = "50%";
                  logoCell.appendChild(logoImg);
                  row.appendChild(logoCell);
  
                  const dateCell = document.createElement("td");
                  dateCell.textContent = `${item.start_league_date} - ${item.end_league_date}`;
                  row.appendChild(dateCell);
  
                  const statusCell = document.createElement("td");
                  statusCell.textContent = getStatus(item.start_league_date, item.end_league_date);
                  row.appendChild(statusCell);
  
                  const viewCell = document.createElement("td");
                  const viewButton = document.createElement("span");
                  viewButton.innerHTML = '<i class="far fa-eye"></i>';
                  viewButton.classList.add('sortable')
                  viewButton.addEventListener("click", async() => {
                     window.location.href = 'view-team-details.html'
                  });
                  viewCell.appendChild(viewButton);
                  row.appendChild(viewCell);
  
                  const editCell = document.createElement("td");
                  const editButton = document.createElement("span");
                  editButton.innerHTML = '<i class="far fa-edit"></i>';
                  editButton.classList.add('sortable')
                  editButton.addEventListener("click", async() => {
                      await handleEdit(item.id);
                  });
                  editCell.appendChild(editButton);
                  row.appendChild(editCell);
  
                  const deleteCell = document.createElement("td");
                  const deleteButton = document.createElement("span");
                  deleteButton.innerHTML = '<i class="far fa-trash-alt"></i>';
                  deleteButton.classList.add('sortable')
                  deleteButton.addEventListener("click", async () => {
                      await handleDelete(item.id);
                  });
                  deleteCell.appendChild(deleteButton);
                  row.appendChild(deleteCell);
  
                  if (statusCell.textContent === 'completed') {
                      noCell.classList.add('disabled-row');
                      fullNameCell.classList.add('disabled-row');
                      shortNameCell.classList.add('disabled-row');
                      logoCell.classList.add('disabled-row');
                      dateCell.classList.add('disabled-row');
                      statusCell.classList.add('disabled-row');
                      
                      editCell.classList.add('disabled-row');
                  }
  
                  tbody.appendChild(row);
              });
          }
      }
  
      const totalPages = Math.ceil(totalItems / itemsPerPage);


      function getStatus(startDate, endDate) {
          const now = new Date();
          const start = new Date(startDate);
          const end = new Date(endDate);
  
          if (now < start) {
              return 'upcoming';
          } else if (now > end) {
              return 'completed';
          } else {
              return 'running';
          }
      }





// Call the function to generate initial pagination
// generatePaginationLinks();
      async function handleDelete(id) {
          const url = `https://jadavnilesh.pythonanywhere.com/get/${id}/`;
          const response = await myFetch(url, "DELETE");
  
          if (response.ok) {
              await myFetch("https://jadavnilesh.pythonanywhere.com/get/", "GET");
          }
      }
  
      async function handleEdit(id) {
          const url = `https://jadavnilesh.pythonanywhere.com/get/${id}/`;
          try {
              await myFetch(url, "GET");
              window.location.href = `editteam.html?id=${id}`;
          } catch (error) {
              console.error("Error fetching data:", error);
          }
      }
  
      function filterTable() {
          const filterInput = document.querySelector('#filter-input').value.toLowerCase();
          const filteredData = allData.filter(item => {
              const rowText = `${item.league_name} ${item.short_league_name} ${item.start_league_date} ${item.end_league_date}`.toLowerCase();
             
          
              return rowText.includes(filterInput);
          });
          currentPage = 1; // Reset to the first page
          populateTable(filteredData);
          updatePagination(filteredData);
         
      }
  
      function updatePagination(data = allData) {
          const totalPages = Math.ceil(data.length / itemsPerPage);
          // document.querySelector('#page-info').value = `Page ${currentPage} of ${totalPages}`;
  
          document.querySelector('#prev-button').disabled = currentPage === 1;
          document.querySelector('#next-button').disabled = currentPage === totalPages;
      }
  
      function goToPage(page) {
          currentPage = page;
          populateTable(allData);
          updatePagination();
      }
  
      window.addEventListener('DOMContentLoaded', () => {
          document.querySelector('#filter-input').addEventListener('input', filterTable);
          document.querySelector('#prev-button').addEventListener('click', () => goToPage(currentPage - 1));
          document.querySelector('#next-button').addEventListener('click', () => goToPage(currentPage + 1));
          myFetch("https://jadavnilesh.pythonanywhere.com/get/", "GET");
        });
  </script> -->

    <script>
      var rankList = [];
      var array = [];
      var array_length = 0;
      var table_size = 10;
      var start_index = 1;
      var end_index = 0;
      var current_index = 1;
      var max_index = 0;

      async function fetchData() {
        try {
          const response = await fetch(
            "https://goldfish-app-esdkb.ondigitalocean.app/team_get/",
            {
              method: "GET",
              headers: {
                "Content-Type": "application/json",
              },
            }
          );

          if (response.ok) {
            const data = await response.json();
            if (data && data.status === "success") {
              const rankList = data.data;
              const array = rankList; // Initialize array with fetched data
              console.log(array);
              displayIndexButtons();
            } else {
              console.error("Error: Invalid data format");
            }
          } else {
            console.error("Error fetching data", response.statusText);
          }
        } catch (error) {
          console.error("Error fetching data", error);
        }
      }

      // Call the fetchData function
      fetchData();

      function preLoadCalculations() {
        array_length = array.length;
        max_index = Math.ceil(array_length / table_size);
      }

      $(document).ready(function () {
        // Search input event handler
        $("#tab_filter_text").on("input", function () {
          filterRankList(); // Trigger filtering when search text changes
        });

        // Date range picker configuration and event handling
        // $('#datefilter').daterangepicker({
        //     autoUpdateInput: false,
        //     locale: {
        //         cancelLabel: 'Clear',
        //         format: 'DD/MM/YYYY'
        //     }
        // });

        $("#datefilter").on("apply.daterangepicker", function (ev, picker) {
          $(this).val(
            picker.startDate.format("DD/MM/YYYY") +
              " - " +
              picker.endDate.format("DD/MM/YYYY")
          );
          $("#clearDateBtn").show();
          filterRankList(); // Trigger filtering when date range is applied
        });

        $("#datefilter").on("cancel.daterangepicker", function (ev, picker) {
          $(this).val("");
          $("#clearDateBtn").hide();
          filterRankList(); // Trigger filtering when date range is cleared
        });

        $("#clearDateBtn").click(function () {
          $("#datefilter").val("start & end date");
          $(this).hide();
          filterRankList(); // Trigger filtering when clear button is clicked
        });

        // Status dropdown event handling
        $("#statusDropdown").change(function () {
          var status = $(this).val().toLowerCase();
          filterRankList(); // Trigger filtering with selected status
        });

        // Initial call to fetch data
        fetchData();
      });

      function filterRankList() {
        var tab_filter_text = $("#tab_filter_text").val().toLowerCase().trim();
        var datefilter = $("#datefilter").val().trim();
        var statusFilter = $("#statusDropdown").val()
          ? $("#statusDropdown").val().toLowerCase()
          : "";
        var startDate, endDate;

        if (datefilter !== "" && datefilter !== "start & end date") {
          var dates = datefilter.split(" - ");
          startDate = new Date(dates[0]);
          endDate = new Date(dates[1]);
        }

        var filteredArray = rankList.filter(function (object) {
          var matchesText = true,
            matchesStatus = true,
            matchesDate = true;

          if (tab_filter_text !== "") {
            matchesText =
              (object.league_name &&
                object.league_name.toLowerCase().includes(tab_filter_text)) ||
              (object.short_league_name &&
                object.short_league_name
                  .toLowerCase()
                  .includes(tab_filter_text)) ||
              (object.start_league_date &&
                object.start_league_date
                  .toLowerCase()
                  .includes(tab_filter_text)) ||
              (object.end_league_date &&
                object.end_league_date.toLowerCase().includes(tab_filter_text));
          }

          // if (statusFilter !== '') {
          //     const status = getStatus(object.start_league_date, object.end_league_date);
          //     matchesStatus = (status === statusFilter);
          //   }

          if (datefilter !== "" && datefilter !== "start & end date") {
            matchesDate =
              new Date(object.start_league_date) >= startDate &&
              new Date(object.end_league_date) <= endDate;
          }

          return matchesText && matchesStatus && matchesDate;
        });

        array = filteredArray;
        current_index = 1;
        displayIndexButtons();
      }

      // Function to get status based on start and end dates
      //     function getStatus(start_date, end_date) {
      //   var currentDate = new Date();
      //   var startDate = moment(start_date, "DD/MM/YYYY").toDate(); // Convert start_date to Date object using moment.js
      //   var endDate = moment(end_date, "DD/MM/YYYY").toDate(); // Convert end_date to Date object using moment.js

      //   if (startDate < currentDate && currentDate <= endDate) {
      //       return "running";
      //   } else if (startDate < currentDate && endDate < currentDate) {
      //       return "completed";
      //   } else if (startDate > currentDate && endDate > currentDate) {
      //       return "upcoming";
      //   } else {
      //       return "unknown"; // Handle cases where the conditions don't match any of the above
      //   }
      // }

      function displayIndexButtons() {
        preLoadCalculations();
        $(".index_buttons ul").empty();
        $(".index_buttons ul").append(
          '<button class="paginate_button page-item previous" onclick="prev()">Previous</button>'
        );

        for (let i = 1; i <= max_index; i++) {
          $(".index_buttons ul").append(
            '<button class="paginate_button page-item " onclick="indexPagination(' +
              i +
              ')" class="index-button" data-index="' +
              i +
              '">' +
              i +
              "</button>"
          );
        }
        $(".index_buttons ul").append(
          '<button class="paginate_button page-item next" onclick="next()">Next</button>'
        );
        highlightIndexButton();
      }

      function highlightIndexButton() {
        start_index = (current_index - 1) * table_size + 1;
        end_index = start_index + table_size - 1;
        if (end_index > array_length) {
          end_index = array_length;
        }
        $(".footer span").text(
          "Showing " +
            start_index +
            " to " +
            end_index +
            " of " +
            array_length +
            " entries"
        );
        $(".index_buttons ul button").removeClass("active");
        $(
          '.index_buttons ul button[data-index="' + current_index + '"]'
        ).addClass("active");

        displayTableRows();
      }

      function displayTableRows() {
        $("table tbody").empty();
        var tab_start = start_index - 1;
        var tab_end = end_index;

        for (var i = tab_start; i < tab_end; i++) {
          var student = array[i];
          // var status = getStatus(
          //     student["start_league_date"],
          //     student["end_league_date"]
          // );

          var tr = $("<tr></tr>");

          var noCell = $("<td></td>").text(i + 1);
          var teamNameCell = $("<td></td>").text(student["team_name"] || "");
          var shortNameCell = $("<td></td>").text(
            student["team_short_name"] || ""
          );
          var leagueCell = $("<td></td>").text(student["league_name"] || "");
          var logoCell = $("<td></td>").html(
            student["team_image"]
              ? '<img src="https://goldfish-app-esdkb.ondigitalocean.app' +
                  student["team_image"] +
                  '" alt="' +
                  student["team_image"] +
                  '" class="team-logo">'
              : ""
          );

          var dateCell = $("<td></td>").text(student["team_date"] || "");
          var statusCell = $("<td></td>").text(status);
          var viewCell = $("<td></td>").html(
            '<span class="sortable" onclick="window.location.href=\'view-team-details.html\'"><i class="far fa-eye"></i></span>'
          );
          var editCell = $("<td></td>").html(
            '<span class="sortable" onclick="handleEdit(' +
              student["id"] +
              ')"><i class="far fa-edit"></i></span>'
          );
          var deleteCell = $("<td></td>").html(
            '<span class="sortable" onclick="handleDelete(' +
              student["id"] +
              ')"><i class="far fa-trash-alt"></i></span>'
          );

          // Append cells to the row
          tr.append(noCell)
            .append(teamNameCell)
            .append(shortNameCell)
            .append(leagueCell)
            .append(logoCell)
            .append(dateCell)
            .append(viewCell)
            .append(editCell)
            .append(deleteCell);

          // Apply 'disabled-row' class if the status is 'completed'
          // if (status === "completed") {
          //     noCell.addClass("disabled-row");
          //     fullNameCell.addClass("disabled-row");
          //     shortNameCell.addClass("disabled-row");
          //     logoCell.addClass("disabled-row");
          //     dateCell.addClass("disabled-row");
          //     statusCell.addClass("disabled-row");
          //     editCell.addClass("disabled-row");
          // }

          // Append the row to the table body
          $("table tbody").append(tr);
        }
      }

      async function handleDelete(id) {
        const url = `https://goldfish-app-esdkb.ondigitalocean.app/team_get/${id}/`;
        try {
          const response = await fetch(url, {
            method: "DELETE",
          });

          if (response.ok) {
            // Fetch the updated list of leagues after deletion
            await fetchData();
          } else {
            console.error("Failed to delete the league");
          }
        } catch (error) {
          console.error("Error deleting data:", error);
        }
      }

      async function handleEdit(id) {
        const url = `https://goldfish-app-esdkb.ondigitalocean.app/team_get/${id}/`;
        try {
          const response = await fetch(url);

          if (response.ok) {
            // Redirect to edit page with the league ID
            window.location.href = `editleague.html?id=${id}`;
          } else {
            console.error("Failed to fetch the league data");
          }
        } catch (error) {
          console.error("Error fetching data:", error);
        }
      }

      function indexPagination(index) {
        current_index = index;
        highlightIndexButton();
      }

      function prev() {
        if (current_index > 1) {
          current_index--;
          highlightIndexButton();
        }
      }

      function next() {
        if (current_index < max_index) {
          current_index++;
          highlightIndexButton();
        }
      }
    </script>
  </body>
</html>
