<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Pool A</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta content="Premium Multipurpose Admin & Dashboard Template" name="description" />
  <meta content="Themesdesign" name="author" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <!-- App favicon -->
  <!-- <link rel="shortcut icon" href="./assets/images/favicon.ico" /> -->
  <link rel="icon" href="./assets/images/krinikIn_Logo.svg" type="image/x-icon">
  <!-- DataTables -->
  <link href="./assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
  <link href="./assets/libs/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css" rel="stylesheet"
    type="text/css" />
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,300,0,0" />
  <!-- Responsive datatable examples -->
  <link href="./assets/libs/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css" rel="stylesheet"
    type="text/css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- datepicker -->
  <link href="./assets/libs/air-datepicker/air-datepicker.css" rel="stylesheet" />

  <!-- jvectormap -->
  <!-- <link href="./assets/libs/jqvmap/jqvmap.min.css" rel="stylesheet" /> -->

  <!-- Bootstrap Css -->
  <link href="./assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <!-- Icons Css -->
  <link href="./assets/css/icons.min.css" rel="stylesheet" type="text/css" />
  <!-- App Css-->
  <link href="./assets/css/app.css" rel="stylesheet" type="text/css" />
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

  <style>
    .select-box-wrapper {
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 5px;
      background-color: #f9f9f9;
    }

    .select-wrapper {
      position: relative;
    }

    .select-wrapper select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      padding-right: 30px;
    }

    .select-wrapper .select-icon {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      color: #555;
    }

    .mainnn {

      margin-top: 70px !important;
    }

    input {
      text-align: center;

    }

    .page-content-wrapper {
      background-color: white;
      padding-bottom: 35px;
    }
  </style>
</head>

<body data-topbar="colored">
  <div id="layout-wrapper">
    <header id="page-topbar" class="">
      <div class="navbar-header ">
        <div class="d-flex ">
          <!-- LOGO -->
          <div class="navbar-brand-box">
            <a href="./dashboard.html" class="logo logo-dark">
              <span class="logo-sm">
                
                <img src="./assets/images/krinikIn_Logo.svg" alt="" />
              </span>
              <span class="logo-lg">
              
                <img src="./assets/images/krinikIn_Logo.svg" alt=""  />
              </span>
            </a>

            <a href="index.html" class="logo logo-light ">
              <span class="logo-sm">
             
                <img src="./assets/images/krinikIn_Logo.svg" alt=""  />
              </span>
              <span class="logo-lg">
                
                <img src="./assets/images/krinikIn_Logo.svg" alt="" />
              </span>
            </a>
          </div>

          <button type="button" class="btn btn-sm px-3 font-size-24 header-item waves-effect " id="vertical-menu-btn">
            <i class="mdi mdi-backburger "></i>
          </button>

          <!-- App Search-->
          <!-- <form class="app-search d-none d-lg-block">
                            <div class="position-relative mt-3">
                                <input type="text" class="form-control" placeholder="Search...">
                                <span class="mdi mdi-magnify"></span>
                            </div>
                        </form> -->
        </div>

        <div class="  d-flex justify-content-center gap-4 time_show1">
          <div class="dropdown d-flex justify-content-end ms-2  " id="enterotpdiv">
            <!-- <button id="showotppage" type="button" class="btn btn-primary2  waves-effect" 
             >Enter OTP
            </button> -->
            
          </div>
        
          <div class="dropdown   dblock">
            <div id="time_show" class="btn-primary2  px-3">
            </div>
          </div>

          
        </div>
        
      </div>
    </header>

        <!-- ========== Left Sidebar Start ========== -->
        <div class="vertical-menu ">
          <div data-simplebar class="h-100 ">
            <!--- Sidemenu -->
            <div id="sidebar-menu" class="">
              <!-- Left Menu Start -->
              <ul class="metismenu list-unstyled " id="side-menu">
                <li class="menu-title">Menu</li>
    
                <li>
                  <a href="./dashboard.html" class="waves-effect">
                    <div class=" icons-sm icon-set">
                      <span class="material-symbols-outlined icon-margin">
                        dashboard
                        </span>
                   
                    <span>Dashboard</span>
                    </div>
                  </a>
                </li>
    
                <li>
                  <a href="./user.html" class="waves-effect">
                    <div class="icons-sm icon-set">
                      <span class="material-symbols-outlined icon-margin">
                        person
                        </span>
                   
                    <span>User</span>
                  </div>
                  </a>
                </li>
    
                <li>
                  <a href="javascript: void(0);" class=" ">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        sports_cricket
                        </span>                    
                        <span class="has-arrow waves-effect ">Sports Configuration</span>
                                        
                      </div> 
                      
                    </a>
    
                  <ul class="sub-menu" aria-expanded="false">
                    <li><a href="./manage-league.html">Manage Leagues</a></li>
                    <li><a href="./manage-team.html">Manage Teams</a></li>
                    <li><a href="./manage-player.html">Manage Players</a></li>
                  </ul>
                </li>
                
                <li>
                  <a href="javascript: void(0);" class=" ">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        crossword
                        </span>                   
                        <span class="has-arrow has-arrow1 waves-effect ">Manage Contest</span>
                                        
                      </div> 
                      
                    </a>
    
                  <ul class="sub-menu" aria-expanded="false">
                    <li><a href="./manage-match.html">Manage Match</a></li>
                    <li><a href="./manage-pool.html">Manage Pools</a></li>
                  </ul>
                </li>
    
                <li class="otp-exempt" style="display:none">
                  <a href="javascript: void(0);" class=" ">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        receipt_long
                        </span>                 
                        <span class="has-arrow has-arrow2 waves-effect ">Transactions</span>
                                        
                      </div> 
                      
                    </a>
    
                  <ul class="sub-menu" aria-expanded="false">
                    <li><a href="./all-transaction.html">All Transaction</a></li>
                    <li><a href="./wallet-transaction.html">Wallet Transaction</a></li>
                    <li><a href="./game-transaction.html">Game Transaction</a></li>
                  </ul>
                </li>
    
                <li class="otp-exempt" style="display:none">
                  <a href="./account-setting.html" class="waves-effect">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        settings
                        </span>
                        <span>Account Setting</span>
                    </div>
                  </a>
                </li>
                <li class="otp-exempt" style="display:none">
                  <a href="./advertise.html" class="waves-effect">
                    <div class="icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin">
                        ad
                        </span>
                        <span>Advertise</span>
                    </div>
                  </a>
                </li>
                <li>
                  <a href="./kyc.html" class="waves-effect">
                    <div class="icons-sm icon-set">
                      <span class="material-symbols-outlined icon-margin">
                        person
                        </span>
                   
                    <span>KYC</span>
                  </div>
                  </a>
                </li>
    
                <li>
                  <a href="" class="waves-effect " id="logoutButton">
                    <div class=" icons-sm icon-set ">
                      <span class="material-symbols-outlined icon-margin ">
                        logout
                        </span>
                        <span class="">Logout</span>
                    </div>
                  </a>
                </li>
    
              
                        </ul>
            </div>
            <!-- Sidebar -->
          </div>
        </div>
        <!-- Left Sidebar End -->

    <!-- ============================================================== -->
    <!-- Start right Content here -->
    <!-- ============================================================== -->
    <div class="main-content">
      <div class="page-content">
        <div class="page-title-box">
          <div class="container-fluid">
            <div class="row align-items-center">
              <div>
                <h4 class="page-title mb-1">Create Pairs</h4>
              </div>
            </div>
          </div>
        </div>
        <div class="page-content-wrapper">
          <div class="container-fluid">
            <div class="row justify-content-center">
              <div class="col-lg-6 col-sm-12">
                <div class="card-body mt-4">
                  <h5 class="text-center" id="matchHeading">Enter Pairs</h5>
                  <div id="pairsInputContainer">
                    <!-- Dynamic pair inputs will be inserted here -->
                  </div>
                  <div class="text-center mt-3">
                    <button class="btn btn-secondary" type="button" id="addPairButton">Add Pair</button>
                  </div>
                </div>
              </div>
              <div class="col-lg-5 col-sm-12">
                <div class="card-body mt-4">
                  <h5 class="text-center" id="createdPairsHeading">Created Pairs</h5>
                  <div id="createdPairsContainer">
                    <!-- Display created pairs here -->
                  </div>
                </div>
              </div>
            </div>
            <div class="mt-5 text-center d-flex justify-content-center gap-3">
              <button class="btn btn-primary grey-btn" type="button" id="cancel-btn"
              onclick="window.location.replace('./manage-pool.html')">skip</button>
              <button class="btn btn-primary" type="button" id="submitPairsButton">Submit Pairs</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- end main content-->
  </div>
  <!-- END layout-wrapper -->








  <!-- </div> -->

</body>
<script src="./assets/js/logout.js"></script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


<script>
  document.addEventListener('DOMContentLoaded', function () {
    const playerPairsContainer = document.getElementById('createdPairsContainer');
    const submitPairsButton = document.getElementById('submitPairsButton');
    const pairsInputContainer = document.getElementById('pairsInputContainer');
    const matchHeading = document.getElementById('matchHeading');
    const addPairButton = document.getElementById('addPairButton');
    const urlParams = new URLSearchParams(window.location.search);
    const matchName = urlParams.get('select_match');
    const poolName = urlParams.get('pool_name');
    const poolType = urlParams.get('pool_type');
    
    console.log(poolType,"olo")

    let allPlayers = [];
    let createdPairs = [];  

    fetch('https://krinik.in/pair_get/')

    
    fetch('https://krinik.in/pair_get/')
      .then(response => response.json())
      .then(data => {
        const matchData = data.data;
        console.log(matchData,"data")
        const selectedMatch = matchData.filter(match => match.select_match.match_display_name === matchName && match.pool_name == poolName && match.pool_type == poolType );
        console.log(selectedMatch,"asdh")
        if (selectedMatch) {
          const teamAName = selectedMatch.select_team_A.team_name;
          const teamBName = selectedMatch.select_team_B.team_name;
          matchHeading.textContent = `${teamAName} vs ${teamBName}`;

          allPlayers = [
            ...selectedMatch.select_player_A.map(player => player.player_name),
            ...selectedMatch.select_player_B.map(player => player.player_name)
          ];

          createPlayerPairDropdown();

          addPairButton.addEventListener('click', createPlayerPairDropdown);
        }
      })
      .catch(error => console.error('Error fetching match data:', error));

    function createPlayerPairDropdown() {
      const inputGroup = document.createElement('div');
      inputGroup.className = 'input-group mb-3';

      const selectA = createPlayerDropdown(allPlayers);
      const selectB = createPlayerDropdown(allPlayers);

      const limitInput = document.createElement('input');
      limitInput.type = 'text';
      limitInput.className = 'form-control';
      limitInput.placeholder = 'Limit';

      selectA.addEventListener('change', function () {
        handleSelectionChange(selectA, selectB, limitInput);
      });

      selectB.addEventListener('change', function () {
        handleSelectionChange(selectA, selectB, limitInput);
      });

      limitInput.addEventListener('input', function () {
        updateCreatedPairs(selectA, selectB, limitInput);
      });

      inputGroup.appendChild(selectA);
      inputGroup.appendChild(selectB);
      inputGroup.appendChild(limitInput);
      pairsInputContainer.appendChild(inputGroup);
    }

    function createPlayerDropdown(players) {
      const selectElement = document.createElement('select');
      selectElement.className = 'form-control player-dropdown';
      const defaultOption = document.createElement('option');
      defaultOption.value = '';
      defaultOption.textContent = 'Select Player';
      selectElement.appendChild(defaultOption);

      players.forEach(player => {
        const option = document.createElement('option');
        option.value = player;
        option.textContent = player;
        selectElement.appendChild(option);
      });

      return selectElement;
    }

    function handleSelectionChange(selectA, selectB, limitInput) {
      const playerA = selectA.value;
      const playerB = selectB.value;

      if (playerA && playerB) {
        if (playerA === playerB) {
          alert('Player A and Player B cannot be the same.');
          selectA.value = '';
          selectB.value = '';
        } else if (pairExists(playerA, playerB)) {
          alert('This pair already exists.');
          selectA.value = '';
          selectB.value = '';
        } else {
          limitInput.value = '';
          createdPairs = createdPairs.filter(pair => !(pair.player_1 === playerA && pair.player_2 === playerB || pair.player_1 === playerB && pair.player_2 === playerA));
          displayCreatedPairs();
        }
      }
    }

    function updateCreatedPairs(selectA, selectB, limitInput) {
      const playerA = selectA.value;
      const playerB = selectB.value;
      const limit = limitInput.value;

      if (playerA && playerB && limit) {
        const existingPairIndex = createdPairs.findIndex(pair => (pair.player_1 === playerA && pair.player_2 === playerB) || (pair.player_1 === playerB && pair.player_2 === playerA));

        if (existingPairIndex !== -1) {
          createdPairs[existingPairIndex].limit = parseInt(limit, 10);
        } else {
          createdPairs.push({
            player_1: playerA,
            player_2: playerB,
            limit: parseInt(limit, 10)
          });
        }
        displayCreatedPairs();
      }
    }

    function pairExists(playerA, playerB) {
      return createdPairs.some(pair => {
        return (pair.player_1 === playerA && pair.player_2 === playerB) ||
          (pair.player_1 === playerB && pair.player_2 === playerA);
      });
    }

    function displayCreatedPairs() {
      playerPairsContainer.innerHTML = '';
      createdPairs.forEach(pair => {
        const pairText = document.createElement('div');
        pairText.textContent = `[${pair.player_1}, ${pair.player_2}, Limit: ${pair.limit}]`;
        playerPairsContainer.appendChild(pairText);
      });
    }

    submitPairsButton.addEventListener('click', function () {
      if (createdPairs.length === 0) {
        alert('No pairs created.');
        return;
      }

      createdPairs.forEach(pair => {
        const payload = {
          pool_name: poolName,
          select_match: matchName,
          player_1: pair.player_1,
          player_2: pair.player_2,
          limit: pair.limit
        };

        fetch('https://krinik.in/pair_get/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(payload),
        })
          .then(response => {
            if (!response.ok) {
              console.error('Network response was not ok. Status:', response.status, 'Status Text:', response.statusText);
              throw new Error('Network response was not ok');
            }
            return response.json();
          })
          .then(data => {
            console.log('Success:', data);
            window.location.href = "./manage-pool.html"
          })
          .catch(error => {
            console.error('Error:', error);
          });
      });
    });
  });


  // <script src="assets/libs/jquery/jquery.min.js"></script>
        <script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="assets/libs/metismenu/metisMenu.min.js"></script>
        <script src="assets/libs/simplebar/simplebar.min.js"></script>
        <script src="assets/libs/node-waves/waves.min.js"></script>

        <script src="https://unicons.iconscout.com/release/v2.0.1/script/monochrome/bundle.js"></script>


        <script src="assets/js/app.js"></script>

</script>





<!-- Bootstrap JS scripts (example) -->










</html>